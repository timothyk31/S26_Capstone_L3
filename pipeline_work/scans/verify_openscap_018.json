[
  {
    "id": "openscap_001",
    "title": "Enable Dracut FIPS Module",
    "description": "Red Hat Enterprise Linux 9 has an installation-time kernel flag that can enable FIPS mode. The installer must be booted with fips=1 for the system to have FIPS mode enabled. Enabling FIPS mode on a preexisting system is not supported. If this rule fails on an installed system, then this is a permanent finding and cannot be fixed. To enable FIPS, the system requires that the fips module is added in dracut configuration. Check if /etc/dracut.conf.d/40-fips.conf contain add_dracutmodules+=\" fips \"",
    "severity": "3",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_enable_dracut_fips_module",
    "rule": "xccdf_org.ssgproject.content_rule_enable_dracut_fips_module",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Review and remediate: Enable Dracut FIPS Module"
  },
  {
    "id": "openscap_002",
    "title": "Enable FIPS Mode",
    "description": "Red Hat Enterprise Linux 9 has an installation-time kernel flag that can enable FIPS mode. The installer must be booted with fips=1 for the system to have FIPS mode enabled. Enabling FIPS mode on a preexisting system is not supported. If this rule fails on an installed system, then this is a permanent finding and cannot be fixed. To enable FIPS mode at bootable container build time configure fips=1 kernel argument in /usr/lib/bootc/kargs.d/01-fips.toml: kargs = [\"fips=1\"] Then set the cryptographic policy to : update-crypto-policies --no-reload --set",
    "severity": "3",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_enable_fips_mode",
    "rule": "xccdf_org.ssgproject.content_rule_enable_fips_mode",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if ( ! ( [ \"${container:-}\" == \"bwrap-osbuild\" ] ) && rpm --quiet -q kernel-core ); then if { rpm --quiet -q kernel rpm-ostree bootc && ! rpm --quiet -q openshift-kubelet && { [ -f \"/run/.containerenv\" ] || [ -f \"/.containerenv\" ]; }; }; then cat > /usr/lib/bootc/kargs.d/01-fips.toml << EOF kargs = [\"fips=1\"] EOF fi else >&2 echo 'Remediation is not applicable, nothing was done' fi"
  },
  {
    "id": "openscap_003",
    "title": "Set kernel parameter 'crypto.fips_enabled' to 1",
    "description": "System running in FIPS mode is indicated by kernel parameter 'crypto.fips_enabled'. This parameter should be set to 1 in FIPS mode. Red Hat Enterprise Linux 9 has an installation-time kernel flag that can enable FIPS mode. The installer must be booted with fips=1 for the system to have FIPS mode enabled. Enabling FIPS mode on a preexisting system is not supported. If this rule fails on an installed system, then this is a permanent finding and cannot be fixed. To enable strict FIPS compliance, the fips=1 kernel option needs to be added to the kernel boot parameters during system installation so key generation is done with FIPS-approved algorithms and continuous monitoring tests in place.",
    "severity": "3",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_sysctl_crypto_fips_enabled",
    "rule": "xccdf_org.ssgproject.content_rule_sysctl_crypto_fips_enabled",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Review and remediate: Set kernel parameter 'crypto.fips_enabled' to 1"
  },
  {
    "id": "openscap_004",
    "title": "Configure SSH Client to Use FIPS 140-2 Validated MACs: openssh.config",
    "description": "Crypto Policies provide a centralized control over crypto algorithms usage of many packages. OpenSSH is supported by system crypto policy, but the OpenSSH configuration may be set up incorrectly. To check that Crypto Policies settings are configured correctly, ensure that /etc/crypto-policies/back-ends/openssh.config contains the following line and is not commented out: MACs",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_harden_sshd_macs_openssh_conf_crypto_policy",
    "rule": "xccdf_org.ssgproject.content_rule_harden_sshd_macs_openssh_conf_crypto_policy",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Review and remediate: Configure SSH Client to Use FIPS 140-2 Validated MACs: openssh.config"
  },
  {
    "id": "openscap_005",
    "title": "Configure SSH Server to Use FIPS 140-2 Validated MACs: opensshserver.config",
    "description": "Crypto Policies provide a centralized control over crypto algorithms usage of many packages. OpenSSH is supported by system crypto policy, but the OpenSSH configuration may be set up incorrectly. To check that Crypto Policies settings are configured correctly, ensure that /etc/crypto-policies/back-ends/opensshserver.config contains the following text and is not commented out: -oMACS=",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_harden_sshd_macs_opensshserver_conf_crypto_policy",
    "rule": "xccdf_org.ssgproject.content_rule_harden_sshd_macs_opensshserver_conf_crypto_policy",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Review and remediate: Configure SSH Server to Use FIPS 140-2 Validated MACs: opensshserver.config"
  },
  {
    "id": "openscap_006",
    "title": "The Installed Operating System Is Vendor Supported",
    "description": "The installed operating system must be maintained by a vendor. Red Hat Enterprise Linux is supported by Red Hat, Inc. As the Red Hat Enterprise Linux vendor, Red Hat, Inc. is responsible for providing security patches.",
    "severity": "3",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_installed_OS_is_vendor_supported",
    "rule": "xccdf_org.ssgproject.content_rule_installed_OS_is_vendor_supported",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Review and remediate: The Installed Operating System Is Vendor Supported"
  },
  {
    "id": "openscap_007",
    "title": "Ensure /tmp Located On Separate Partition",
    "description": "The /tmp directory is a world-writable directory used for temporary file storage. Ensure it has its own partition or logical volume at installation time, or migrate it using LVM.",
    "severity": "1",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_partition_for_tmp",
    "rule": "xccdf_org.ssgproject.content_rule_partition_for_tmp",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: part /tmp"
  },
  {
    "id": "openscap_008",
    "title": "Ensure /var Located On Separate Partition",
    "description": "The /var directory is used by daemons and other system services to store frequently-changing data. Ensure that /var has its own partition or logical volume at installation time, or migrate it using LVM.",
    "severity": "1",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_partition_for_var",
    "rule": "xccdf_org.ssgproject.content_rule_partition_for_var",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: part /var"
  },
  {
    "id": "openscap_009",
    "title": "Ensure /var/log Located On Separate Partition",
    "description": "System logs are stored in the /var/log directory. Ensure that /var/log has its own partition or logical volume at installation time, or migrate it using LVM.",
    "severity": "1",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_partition_for_var_log",
    "rule": "xccdf_org.ssgproject.content_rule_partition_for_var_log",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: part /var/log"
  },
  {
    "id": "openscap_010",
    "title": "Ensure /var/log/audit Located On Separate Partition",
    "description": "Audit logs are stored in the /var/log/audit directory. Ensure that /var/log/audit has its own partition or logical volume at installation time, or migrate it using LVM. Make absolutely certain that it is large enough to store all audit logs that will be created by the auditing daemon.",
    "severity": "1",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_partition_for_var_log_audit",
    "rule": "xccdf_org.ssgproject.content_rule_partition_for_var_log_audit",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: part /var/log/audit"
  },
  {
    "id": "openscap_011",
    "title": "Ensure /var/tmp Located On Separate Partition",
    "description": "The /var/tmp directory is a world-writable directory used for temporary file storage. Ensure it has its own partition or logical volume at installation time, or migrate it using LVM.",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_partition_for_var_tmp",
    "rule": "xccdf_org.ssgproject.content_rule_partition_for_var_tmp",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: part /var/tmp"
  },
  {
    "id": "openscap_012",
    "title": "Enable authselect",
    "description": "Configure user authentication setup to use the authselect tool. If authselect profile is selected, the rule will enable the profile.",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_enable_authselect",
    "rule": "xccdf_org.ssgproject.content_rule_enable_authselect",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core; then var_authselect_profile='' authselect current if test \"$?\" -ne 0; then if { rpm --quiet -q kernel rpm-ostree bootc && ! rpm --quiet -q openshift-kubelet && { [ -f \"/run/.containerenv\" ] || [ -f \"/.containerenv\" ]; }; }; then authselect select --force \"$var_authselect_profile\" else authselect select \"$var_authselect_profile\" fi if test \"$?\" -ne 0; then if rpm --quiet --verify pam; then authselect select --force \"$var_authselect_profile\" else echo \"authselect is not used but files from the 'pam' package have been altered, so the authselect configuration won't be forced.\" >&2 fi fi fi else >&2 echo 'Remediation is not applicable, nothing was done' fi"
  },
  {
    "id": "openscap_013",
    "title": "Ensure PAM Enforces Password Requirements - Minimum Digit Characters",
    "description": "The pam_pwquality module's dcredit parameter controls requirements for usage of digits in a password. When set to a negative number, any password will be required to contain that many digits. When set to a positive number, pam_pwquality will grant +1 additional length credit for each digit. Modify the dcredit setting in /etc/security/pwquality.conf to require the use of a digit in passwords.",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_dcredit",
    "rule": "xccdf_org.ssgproject.content_rule_accounts_password_pam_dcredit",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core && { rpm --quiet -q libpwquality; }; then var_password_pam_dcredit='' if grep -sq dcredit /etc/security/pwquality.conf.d/*.conf ; then sed -i \"/dcredit/d\" /etc/security/pwquality.conf.d/*.conf fi # Strip any search characters in the key arg so that the key can be replaced without # adding any search characters to the config file. stripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^dcredit\") # shellcheck disable=SC2059 printf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_dcredit\" # If the key exists, change it. Otherwise, add it to the config_file. # We search for the key string followed by a word boundary (matched by \\>), # so if we search for 'setting', 'setting2' won't match. if LC_ALL=C grep -"
  },
  {
    "id": "openscap_014",
    "title": "Ensure PAM Enforces Password Requirements - Minimum Different Characters",
    "description": "The pam_pwquality module's difok parameter sets the number of characters in a password that must not be present in and old password during a password change. Modify the difok setting in /etc/security/pwquality.conf to equal to require differing characters when changing passwords.",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_difok",
    "rule": "xccdf_org.ssgproject.content_rule_accounts_password_pam_difok",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core && { rpm --quiet -q libpwquality; }; then var_password_pam_difok='' if grep -sq difok /etc/security/pwquality.conf.d/*.conf ; then sed -i \"/difok/d\" /etc/security/pwquality.conf.d/*.conf fi # Strip any search characters in the key arg so that the key can be replaced without # adding any search characters to the config file. stripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^difok\") # shellcheck disable=SC2059 printf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_difok\" # If the key exists, change it. Otherwise, add it to the config_file. # We search for the key string followed by a word boundary (matched by \\>), # so if we search for 'setting', 'setting2' won't match. if LC_ALL=C grep -q -m 1 -i "
  },
  {
    "id": "openscap_015",
    "title": "Ensure PAM Enforces Password Requirements - Maximum Consecutive Repeating Characters from Same Character Class",
    "description": "The pam_pwquality module's maxclassrepeat parameter controls requirements for consecutive repeating characters from the same character class. When set to a positive number, it will reject passwords which contain more than that number of consecutive characters from the same character class. Modify the maxclassrepeat setting in /etc/security/pwquality.conf to equal to prevent a run of ( + 1) or more identical characters.",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_maxclassrepeat",
    "rule": "xccdf_org.ssgproject.content_rule_accounts_password_pam_maxclassrepeat",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core && { rpm --quiet -q libpwquality; }; then var_password_pam_maxclassrepeat='' if grep -sq maxclassrepeat /etc/security/pwquality.conf.d/*.conf ; then sed -i \"/maxclassrepeat/d\" /etc/security/pwquality.conf.d/*.conf fi # Strip any search characters in the key arg so that the key can be replaced without # adding any search characters to the config file. stripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^maxclassrepeat\") # shellcheck disable=SC2059 printf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_maxclassrepeat\" # If the key exists, change it. Otherwise, add it to the config_file. # We search for the key string followed by a word boundary (matched by \\>), # so if we search for 'setting', 'settin"
  },
  {
    "id": "openscap_016",
    "title": "Set Password Maximum Consecutive Repeating Characters",
    "description": "The pam_pwquality module's maxrepeat parameter controls requirements for consecutive repeating characters. When set to a positive number, it will reject passwords which contain more than that number of consecutive characters. Modify the maxrepeat setting in /etc/security/pwquality.conf to equal to prevent a run of ( + 1) or more identical characters.",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_maxrepeat",
    "rule": "xccdf_org.ssgproject.content_rule_accounts_password_pam_maxrepeat",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core && { rpm --quiet -q libpwquality; }; then var_password_pam_maxrepeat='' if grep -sq maxrepeat /etc/security/pwquality.conf.d/*.conf ; then sed -i \"/maxrepeat/d\" /etc/security/pwquality.conf.d/*.conf fi # Strip any search characters in the key arg so that the key can be replaced without # adding any search characters to the config file. stripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^maxrepeat\") # shellcheck disable=SC2059 printf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_maxrepeat\" # If the key exists, change it. Otherwise, add it to the config_file. # We search for the key string followed by a word boundary (matched by \\>), # so if we search for 'setting', 'setting2' won't match. if LC_AL"
  },
  {
    "id": "openscap_017",
    "title": "Ensure PAM Enforces Password Requirements - Minimum Different Categories",
    "description": "The pam_pwquality module's minclass parameter controls requirements for usage of different character classes, or types, of character that must exist in a password before it is considered valid. For example, setting this value to three (3) requires that any password must have characters from at least three different categories in order to be approved. The default value is zero (0), meaning there are no required classes. There are four categories available: * Upper-case characters * Lower-case characters * Digits * Special characters (for example, punctuation) Modify the minclass setting in /etc/security/pwquality.conf entry to require differing categories of characters when changing passwords.",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_minclass",
    "rule": "xccdf_org.ssgproject.content_rule_accounts_password_pam_minclass",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core && { rpm --quiet -q libpwquality; }; then var_password_pam_minclass='' if grep -sq minclass /etc/security/pwquality.conf.d/*.conf ; then sed -i \"/minclass/d\" /etc/security/pwquality.conf.d/*.conf fi # Strip any search characters in the key arg so that the key can be replaced without # adding any search characters to the config file. stripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^minclass\") # shellcheck disable=SC2059 printf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_minclass\" # If the key exists, change it. Otherwise, add it to the config_file. # We search for the key string followed by a word boundary (matched by \\>), # so if we search for 'setting', 'setting2' won't match. if LC_ALL=C g"
  },
  {
    "id": "openscap_018",
    "title": "Ensure PAM Enforces Password Requirements - Minimum Length",
    "description": "The pam_pwquality module's minlen parameter controls requirements for minimum characters required in a password. Add minlen= after pam_pwquality to set minimum password length requirements.",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_minlen",
    "rule": "xccdf_org.ssgproject.content_rule_accounts_password_pam_minlen",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core && { rpm --quiet -q libpwquality; }; then var_password_pam_minlen='' if grep -sq minlen /etc/security/pwquality.conf.d/*.conf ; then sed -i \"/minlen/d\" /etc/security/pwquality.conf.d/*.conf fi # Strip any search characters in the key arg so that the key can be replaced without # adding any search characters to the config file. stripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^minlen\") # shellcheck disable=SC2059 printf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_minlen\" # If the key exists, change it. Otherwise, add it to the config_file. # We search for the key string followed by a word boundary (matched by \\>), # so if we search for 'setting', 'setting2' won't match. if LC_ALL=C grep -q -m "
  },
  {
    "id": "openscap_019",
    "title": "Ensure PAM Enforces Password Requirements - Minimum Special Characters",
    "description": "The pam_pwquality module's ocredit= parameter controls requirements for usage of special (or \"other\") characters in a password. When set to a negative number, any password will be required to contain that many special characters. When set to a positive number, pam_pwquality will grant +1 additional length credit for each special character. Modify the ocredit setting in /etc/security/pwquality.conf to equal to require use of a special character in passwords.",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_ocredit",
    "rule": "xccdf_org.ssgproject.content_rule_accounts_password_pam_ocredit",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core && { rpm --quiet -q libpwquality; }; then var_password_pam_ocredit='' if grep -sq ocredit /etc/security/pwquality.conf.d/*.conf ; then sed -i \"/ocredit/d\" /etc/security/pwquality.conf.d/*.conf fi # Strip any search characters in the key arg so that the key can be replaced without # adding any search characters to the config file. stripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^ocredit\") # shellcheck disable=SC2059 printf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_ocredit\" # If the key exists, change it. Otherwise, add it to the config_file. # We search for the key string followed by a word boundary (matched by \\>), # so if we search for 'setting', 'setting2' won't match. if LC_ALL=C grep -"
  },
  {
    "id": "openscap_020",
    "title": "Ensure PAM Enforces Password Requirements - Authentication Retry Prompts Permitted Per-Session in /etc/security/pwquality.conf",
    "description": "To configure the number of retry prompts that are permitted per-session: Edit the /etc/security/pwquality.conf to include retry= , or a lower value if site policy is more restrictive. The profile requirement is a maximum of retry= prompts per session.",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_pwquality_retry",
    "rule": "xccdf_org.ssgproject.content_rule_accounts_password_pam_pwquality_retry",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core; then var_password_pam_retry='' if grep -sq retry /etc/security/pwquality.conf.d/*.conf ; then sed -i \"/retry/d\" /etc/security/pwquality.conf.d/*.conf fi # Strip any search characters in the key arg so that the key can be replaced without # adding any search characters to the config file. stripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^retry\") # shellcheck disable=SC2059 printf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_retry\" # If the key exists, change it. Otherwise, add it to the config_file. # We search for the key string followed by a word boundary (matched by \\>), # so if we search for 'setting', 'setting2' won't match. if LC_ALL=C grep -q -m 1 -i -e \"^retry\\\\>\" \"/etc/security/pwqual"
  },
  {
    "id": "openscap_021",
    "title": "Ensure PAM Enforces Password Requirements - Minimum Uppercase Characters",
    "description": "The pam_pwquality module's ucredit= parameter controls requirements for usage of uppercase letters in a password. When set to a negative number, any password will be required to contain that many uppercase characters. When set to a positive number, pam_pwquality will grant +1 additional length credit for each uppercase character. Modify the ucredit setting in /etc/security/pwquality.conf to require the use of an uppercase character in passwords.",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_ucredit",
    "rule": "xccdf_org.ssgproject.content_rule_accounts_password_pam_ucredit",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core && { rpm --quiet -q libpwquality; }; then var_password_pam_ucredit='' if grep -sq ucredit /etc/security/pwquality.conf.d/*.conf ; then sed -i \"/ucredit/d\" /etc/security/pwquality.conf.d/*.conf fi # Strip any search characters in the key arg so that the key can be replaced without # adding any search characters to the config file. stripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^ucredit\") # shellcheck disable=SC2059 printf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_ucredit\" # If the key exists, change it. Otherwise, add it to the config_file. # We search for the key string followed by a word boundary (matched by \\>), # so if we search for 'setting', 'setting2' won't match. if LC_ALL=C grep -"
  },
  {
    "id": "openscap_022",
    "title": "Only Authorized Local User Accounts Exist on Operating System",
    "description": "Enterprise Application tends to use the server or virtual machine exclusively. Besides the default operating system user, there should be only authorized local users required by the installed software groups and applications that exist on the operating system. The authorized user list can be customized in the refine value variable var_accounts_authorized_local_users_regex. OVAL regular expression is used for the user list. Configure the system so all accounts on the system are assigned to an active system, application, or user account. Remove accounts that do not support approved system activities or that allow for a normal user to perform administrative-level actions. To remove unauthorized system accounts, use the following command: $ sudo userdel unauthorized_user",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_accounts_authorized_local_users",
    "rule": "xccdf_org.ssgproject.content_rule_accounts_authorized_local_users",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Review and remediate: Only Authorized Local User Accounts Exist on Operating System"
  },
  {
    "id": "openscap_023",
    "title": "Set the Boot Loader Admin Username to a Non-Default Value",
    "description": "The grub2 boot loader should have a superuser account and password protection enabled to protect boot-time settings. To maximize the protection, select a password-protected superuser account with unique name, and modify the /etc/grub.d/01_users configuration file to reflect the account name change. Do not to use common administrator account names like root, admin, or administrator for the grub2 superuser account. Change the superuser to a different username (The default is 'root'). $ sed -i 's/\\(set superusers=\\).*/\\1\"<unique user ID>\"/g' /etc/grub.d/01_users The line mentioned above must be followed by the line export superusers so that the superusers is honored. Once the superuser account has been added, update the grub.cfg file by running: grub2-mkconfig -o /boot/grub2/grub.cfg",
    "severity": "3",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_grub2_admin_username",
    "rule": "xccdf_org.ssgproject.content_rule_grub2_admin_username",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Review and remediate: Set the Boot Loader Admin Username to a Non-Default Value"
  },
  {
    "id": "openscap_024",
    "title": "Set Boot Loader Password in grub2",
    "description": "The grub2 boot loader should have a superuser account and password protection enabled to protect boot-time settings. Since plaintext passwords are a security risk, generate a hash for the password by running the following command: # grub2-setpassword When prompted, enter the password that was selected.",
    "severity": "3",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_grub2_password",
    "rule": "xccdf_org.ssgproject.content_rule_grub2_password",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Review and remediate: Set Boot Loader Password in grub2"
  },
  {
    "id": "openscap_025",
    "title": "Configure Multiple DNS Servers in /etc/resolv.conf",
    "description": "Determine whether the system is using local or DNS name resolution with the following command: $ sudo grep hosts /etc/nsswitch.conf hosts: files dns If the DNS entry is missing from the host's line in the \"/etc/nsswitch.conf\" file, the \"/etc/resolv.conf\" file must be empty. Verify the \"/etc/resolv.conf\" file is empty with the following command: $ sudo ls -al /etc/resolv.conf -rw-r--r-- 1 root root 0 Aug 19 08:31 resolv.conf If the DNS entry is found on the host's line of the \"/etc/nsswitch.conf\" file, then verify the following: Multiple Domain Name System (DNS) Servers should be configured in /etc/resolv.conf. This provides redundant name resolution services in the event that a domain server crashes. To configure the system to contain as least 2 DNS servers, add a corresponding nameserver ip_address entry in /etc/resolv.conf for each DNS server where ip_address is the IP address of a valid DNS server. For example: search example.com nameserver 192.168.0.1 nameserver 192.168.0.2",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_network_configure_name_resolution",
    "rule": "xccdf_org.ssgproject.content_rule_network_configure_name_resolution",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Review and remediate: Configure Multiple DNS Servers in /etc/resolv.conf"
  },
  {
    "id": "openscap_026",
    "title": "Elevate The SELinux Context When An Administrator Calls The Sudo Command",
    "description": "Configure the operating system to elevate the SELinux context when an administrator calls the sudo command. Edit a file in the /etc/sudoers.d directory with the following command: sudo visudo -f /etc/sudoers.d/CUSTOM_FILE Use the following example to build the CUSTOM_FILE in the /etc/sudoers.d directory to allow any administrator belonging to a designated sudoers admin group to elevate their SELinux context with the use of the sudo command: %wheel ALL=(ALL) TYPE=sysadm_t ROLE=sysadm_r ALL",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_selinux_context_elevation_for_sudo",
    "rule": "xccdf_org.ssgproject.content_rule_selinux_context_elevation_for_sudo",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Review and remediate: Elevate The SELinux Context When An Administrator Calls The Sudo Command"
  },
  {
    "id": "openscap_027",
    "title": "Prevent Unrestricted Mail Relaying",
    "description": "Modify the /etc/postfix/main.cf file to restrict client connections to the local network with the following command: $ sudo postconf -e 'smtpd_client_restrictions = permit_mynetworks,reject'",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_postfix_prevent_unrestricted_relay",
    "rule": "xccdf_org.ssgproject.content_rule_postfix_prevent_unrestricted_relay",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core && rpm --quiet -q postfix; then if ! grep -q ^smtpd_client_restrictions /etc/postfix/main.cf; then echo \"smtpd_client_restrictions = permit_mynetworks,reject\" >> /etc/postfix/main.cf else sed -i \"s/^smtpd_client_restrictions.*/smtpd_client_restrictions = permit_mynetworks,reject/g\" /etc/postfix/main.cf fi else >&2 echo 'Remediation is not applicable, nothing was done' fi"
  },
  {
    "id": "openscap_028",
    "title": "Ensure Chrony is only configured with the server directive",
    "description": "Check that Chrony only has time sources configured with the server directive.",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_chronyd_server_directive",
    "rule": "xccdf_org.ssgproject.content_rule_chronyd_server_directive",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Review and remediate: Ensure Chrony is only configured with the server directive"
  },
  {
    "id": "openscap_029",
    "title": "Disable SSH Root Login",
    "description": "The root user should never be allowed to login to a system directly over a network. To disable root login via SSH, add or correct the following line in /etc/ssh/sshd_config.d/00-complianceascode-hardening.conf: PermitRootLogin no",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_sshd_disable_root_login",
    "rule": "xccdf_org.ssgproject.content_rule_sshd_disable_root_login",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core; then mkdir -p /etc/ssh/sshd_config.d touch /etc/ssh/sshd_config.d/00-complianceascode-hardening.conf chmod 0600 /etc/ssh/sshd_config.d/00-complianceascode-hardening.conf LC_ALL=C sed -i \"/^\\s*PermitRootLogin\\s\\+/Id\" \"/etc/ssh/sshd_config\" LC_ALL=C sed -i \"/^\\s*PermitRootLogin\\s\\+/Id\" \"/etc/ssh/sshd_config.d\"/*.conf if [ -e \"/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf\" ] ; then LC_ALL=C sed -i \"/^\\s*PermitRootLogin\\s\\+/Id\" \"/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf\" else touch \"/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf\" fi # make sure file has newline at the end sed -i -e '$a\\' \"/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf\" cp \"/etc/ssh/sshd_config."
  },
  {
    "id": "openscap_030",
    "title": "Enable Certmap in SSSD",
    "description": "SSSD should be configured to verify the certificate of the user or group. To set this up ensure that section like certmap/testing.test/rule_name is setup in /etc/sssd/sssd.conf. For example [certmap/testing.test/rule_name] matchrule =<SAN>.*EDIPI@mil maprule = (userCertificate;binary={cert!bin}) domains = testing.test",
    "severity": "2",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_sssd_enable_certmap",
    "rule": "xccdf_org.ssgproject.content_rule_sssd_enable_certmap",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Review and remediate: Enable Certmap in SSSD"
  },
  {
    "id": "openscap_031",
    "title": "Log USBGuard daemon audit events using Linux Audit",
    "description": "To configure USBGuard daemon to log via Linux Audit (as opposed directly to a file), AuditBackend option in /etc/usbguard/usbguard-daemon.conf needs to be set to LinuxAudit.",
    "severity": "1",
    "result": "fail",
    "oval_id": "xccdf_org.ssgproject.content_rule_configure_usbguard_auditbackend",
    "rule": "xccdf_org.ssgproject.content_rule_configure_usbguard_auditbackend",
    "class": "compliance",
    "host": "localhost",
    "os": "localhost.localdomain",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if ( ! ( grep -sqE \"^.*\\.s390x$\" /proc/sys/kernel/osrelease || grep -sqE \"^s390x$\" /proc/sys/kernel/arch; ) && rpm --quiet -q kernel-core ) && { rpm --quiet -q usbguard; }; then if [ -e \"/etc/usbguard/usbguard-daemon.conf\" ] ; then LC_ALL=C sed -i \"/^[ \\\\t]*AuditBackend=/Id\" \"/etc/usbguard/usbguard-daemon.conf\" else touch \"/etc/usbguard/usbguard-daemon.conf\" fi # make sure file has newline at the end sed -i -e '$a\\' \"/etc/usbguard/usbguard-daemon.conf\" cp \"/etc/usbguard/usbguard-daemon.conf\" \"/etc/usbguard/usbguard-daemon.conf.bak\" # Insert at the end of the file printf '%s\\n' \"AuditBackend=LinuxAudit\" >> \"/etc/usbguard/usbguard-daemon.conf\" # Clean up after ourselves. rm \"/etc/usbguard/usbguard-daemon.conf.bak\" else >&2 echo 'Remediati"
  }
]