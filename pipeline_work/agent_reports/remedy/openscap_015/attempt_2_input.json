{
  "vulnerability": {
    "id": "openscap_015",
    "title": "Ensure PAM Enforces Password Requirements - Minimum Different Categories",
    "severity": "2",
    "cvss": null,
    "host": "localhost",
    "port": null,
    "protocol": null,
    "description": "The pam_pwquality module's minclass parameter controls requirements for usage of different character classes, or types, of character that must exist in a password before it is considered valid. For example, setting this value to three (3) requires that any password must have characters from at least three different categories in order to be approved. The default value is zero (0), meaning there are no required classes. There are four categories available: * Upper-case characters * Lower-case characters * Digits * Special characters (for example, punctuation) Modify the minclass setting in /etc/security/pwquality.conf entry to require differing categories of characters when changing passwords.",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if rpm --quiet -q kernel-core && { rpm --quiet -q libpwquality; }; then var_password_pam_minclass='' if grep -sq minclass /etc/security/pwquality.conf.d/*.conf ; then sed -i \"/minclass/d\" /etc/security/pwquality.conf.d/*.conf fi # Strip any search characters in the key arg so that the key can be replaced without # adding any search characters to the config file. stripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^minclass\") # shellcheck disable=SC2059 printf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_minclass\" # If the key exists, change it. Otherwise, add it to the config_file. # We search for the key string followed by a word boundary (matched by \\>), # so if we search for 'setting', 'setting2' won't match. if LC_ALL=C g",
    "result": "fail",
    "rule": "xccdf_org.ssgproject.content_rule_accounts_password_pam_minclass",
    "oval_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_minclass",
    "scan_class": "compliance",
    "os": "localhost.localdomain"
  },
  "triage_decision": {
    "finding_id": "openscap_015",
    "should_remediate": true,
    "risk_level": "low",
    "reason": "This rule is related to password complexity and does not affect authentication or authorization mechanisms that could lock out access.",
    "requires_human_review": false,
    "estimated_impact": "authentication/authorization affected"
  },
  "attempt_number": 2,
  "previous_attempts": [
    {
      "finding_id": "openscap_015",
      "attempt_number": 1,
      "commands_executed": [
        "grep -q",
        "grep -q \"minclass\" /etc/security/pwquality.conf",
        "sed -i",
        "",
        "sed -i",
        "echo",
        "echo",
        "grep -q",
        "grep -q \"minclass = 4\" /etc/security/pwquality.conf.d/*.conf",
        "grep \"minclass = 4\" /etc/security/pwquality.conf.d/*.conf",
        "grep \"minclass = 4\" /etc/security/pwquality.conf.d/minclass.conf"
      ],
      "files_modified": [
        "/etc/security/pwquality.conf.d/minclass.conf"
      ],
      "files_read": [
        "/etc/security/pwquality.conf.d/*.conf",
        "/etc/security/pwquality.conf.d/*.conf",
        "/etc/pam.d/system-auth"
      ],
      "execution_details": [
        {
          "command": "test -f '/etc/security/pwquality.conf.d/*.conf' && cat '/etc/security/pwquality.conf.d/*.conf' || (echo FILE_NOT_FOUND >&2; exit 2)",
          "stdout": "",
          "stderr": "FILE_NOT_FOUND",
          "exit_code": 2,
          "success": false,
          "duration": 1.0667436122894287,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "test -f '/etc/security/pwquality.conf.d/*.conf' && cat '/etc/security/pwquality.conf.d/*.conf' || (echo FILE_NOT_FOUND >&2; exit 2)",
          "stdout": "",
          "stderr": "FILE_NOT_FOUND",
          "exit_code": 2,
          "success": false,
          "duration": 0.9960362911224365,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "test -f /etc/pam.d/system-auth && cat /etc/pam.d/system-auth || (echo FILE_NOT_FOUND >&2; exit 2)",
          "stdout": "# Generated by authselect on Mon Feb  9 23:55:07 2026\n# Do not modify this file manually.\n\nauth        required                                     pam_env.so\nauth        required                                     pam_faildelay.so delay=2000000\nauth        required                                     pam_faillock.so preauth silent\nauth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular\nauth        [default=2 ignore=ignore success=ok]         pam_localuser.so\nauth        [success=done authinfo_unavail=ignore user_unknown=ignore ignore=ignore default=die] pam_sss.so try_cert_auth\nauth        sufficient                                   pam_unix.so\nauth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular\nauth        sufficient                                   pam_sss.so forward_pass\nauth        required                                     pam_faillock.so authfail\nauth        required                                     pam_deny.so\n\naccount     required                                     pam_faillock.so\naccount     required                                     pam_unix.so\naccount     sufficient                                   pam_localuser.so\naccount     sufficient                                   pam_usertype.so issystem\naccount     [default=bad success=ok user_unknown=ignore] pam_sss.so\naccount     required                                     pam_permit.so\n\npassword    requisite                                    pam_pwquality.so local_users_only\npassword    sufficient                                   pam_unix.so sha512 shadow  use_authtok rounds=100000\npassword    [success=1 default=ignore]                   pam_localuser.so\npassword    sufficient                                   pam_sss.so use_authtok\npassword    required                                     pam_deny.so\n\nsession     optional                                     pam_keyinit.so revoke\nsession     required                                     pam_limits.so\n-session    optional                                     pam_systemd.so\nsession     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid\nsession     required                                     pam_unix.so\nsession     optional                                     pam_sss.so\n",
          "stderr": "",
          "exit_code": 0,
          "success": true,
          "duration": 1.3199381828308105,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "grep -q",
          "stdout": "",
          "stderr": "Usage: grep [OPTION]... PATTERNS [FILE]...\nTry 'grep --help' for more information.",
          "exit_code": 2,
          "success": false,
          "duration": 1.2555978298187256,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "grep -q \"minclass\" /etc/security/pwquality.conf",
          "stdout": "",
          "stderr": "",
          "exit_code": 0,
          "success": true,
          "duration": 1.186619520187378,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "sed -i",
          "stdout": "",
          "stderr": "Usage: sed [OPTION]... {script-only-if-no-other-script} [input-file]...\n\n  -n, --quiet, --silent\n                 suppress automatic printing of pattern space\n      --debug\n                 annotate program execution\n  -e script, --expression=script\n                 add the script to the commands to be executed\n  -f script-file, --file=script-file\n                 add the contents of script-file to the commands to be executed\n  --follow-symlinks\n                 follow symlinks when processing in place\n  -i[SUFFIX], --in-place[=SUFFIX]\n                 edit files in place (makes backup if SUFFIX supplied)\n  -c, --copy\n                 use copy instead of rename when shuffling files in -i mode\n  -b, --binary\n                 does nothing; for compatibility with WIN32/CYGWIN/MSDOS/EMX \n                 (open files in binary mode; CR+LF are not processed specially)\n  -l N, --line-length=N\n                 specify the desired line-wrap length for the `l' command\n  --posix\n                 disable all GNU extensions.\n  -E, -r, --regexp-extended\n                 use extended regular expressions in the script\n                 (for portability use POSIX -E).\n  -s, --separate\n                 consider files as separate rather than as a single,\n                 continuous long stream.\n      --sandbox\n                 operate in sandbox mode (disable e/r/w commands).\n  -u, --unbuffered\n                 load minimal amounts of data from the input files and flush\n                 the output buffers more often\n  -z, --null-data\n                 separate lines by NUL characters\n      --help     display this help and exit\n      --version  output version information and exit\n\nIf no -e, --expression, -f, or --file option is given, then the first\nnon-option argument is taken as the sed script to interpret.  All\nremaining arguments are names of input files; if no input files are\nspecified, then the standard input is read.\n\nGNU sed home page: <https://www.gnu.org/software/sed/>.\nGeneral help using GNU software: <https://www.gnu.org/gethelp/>.",
          "exit_code": 1,
          "success": false,
          "duration": 1.1699292659759521,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "",
          "stdout": "",
          "stderr": "No command provided",
          "exit_code": null,
          "success": false,
          "duration": 0.0,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "sed -i",
          "stdout": "",
          "stderr": "Usage: sed [OPTION]... {script-only-if-no-other-script} [input-file]...\n\n  -n, --quiet, --silent\n                 suppress automatic printing of pattern space\n      --debug\n                 annotate program execution\n  -e script, --expression=script\n                 add the script to the commands to be executed\n  -f script-file, --file=script-file\n                 add the contents of script-file to the commands to be executed\n  --follow-symlinks\n                 follow symlinks when processing in place\n  -i[SUFFIX], --in-place[=SUFFIX]\n                 edit files in place (makes backup if SUFFIX supplied)\n  -c, --copy\n                 use copy instead of rename when shuffling files in -i mode\n  -b, --binary\n                 does nothing; for compatibility with WIN32/CYGWIN/MSDOS/EMX \n                 (open files in binary mode; CR+LF are not processed specially)\n  -l N, --line-length=N\n                 specify the desired line-wrap length for the `l' command\n  --posix\n                 disable all GNU extensions.\n  -E, -r, --regexp-extended\n                 use extended regular expressions in the script\n                 (for portability use POSIX -E).\n  -s, --separate\n                 consider files as separate rather than as a single,\n                 continuous long stream.\n      --sandbox\n                 operate in sandbox mode (disable e/r/w commands).\n  -u, --unbuffered\n                 load minimal amounts of data from the input files and flush\n                 the output buffers more often\n  -z, --null-data\n                 separate lines by NUL characters\n      --help     display this help and exit\n      --version  output version information and exit\n\nIf no -e, --expression, -f, or --file option is given, then the first\nnon-option argument is taken as the sed script to interpret.  All\nremaining arguments are names of input files; if no input files are\nspecified, then the standard input is read.\n\nGNU sed home page: <https://www.gnu.org/software/sed/>.\nGeneral help using GNU software: <https://www.gnu.org/gethelp/>.",
          "exit_code": 1,
          "success": false,
          "duration": 1.7986230850219727,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "echo",
          "stdout": "\n",
          "stderr": "",
          "exit_code": 0,
          "success": true,
          "duration": 1.3433618545532227,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "echo",
          "stdout": "\n",
          "stderr": "",
          "exit_code": 0,
          "success": true,
          "duration": 1.2569777965545654,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "echo bWluY2xhc3M9NA== | base64 -d > /etc/security/pwquality.conf.d/minclass.conf.tmp && chmod 0644 /etc/security/pwquality.conf.d/minclass.conf.tmp && mv /etc/security/pwquality.conf.d/minclass.conf.tmp /etc/security/pwquality.conf.d/minclass.conf",
          "stdout": "",
          "stderr": "",
          "exit_code": 0,
          "success": true,
          "duration": 1.212862253189087,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "grep -q",
          "stdout": "",
          "stderr": "Usage: grep [OPTION]... PATTERNS [FILE]...\nTry 'grep --help' for more information.",
          "exit_code": 2,
          "success": false,
          "duration": 1.1894598007202148,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "grep -q \"minclass = 4\" /etc/security/pwquality.conf.d/*.conf",
          "stdout": "",
          "stderr": "",
          "exit_code": 1,
          "success": false,
          "duration": 1.141596794128418,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "grep \"minclass = 4\" /etc/security/pwquality.conf.d/*.conf",
          "stdout": "",
          "stderr": "",
          "exit_code": 1,
          "success": false,
          "duration": 1.140211582183838,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        },
        {
          "command": "grep \"minclass = 4\" /etc/security/pwquality.conf.d/minclass.conf",
          "stdout": "",
          "stderr": "",
          "exit_code": 1,
          "success": false,
          "duration": 1.1623201370239258,
          "timed_out": false,
          "truncated_stdout": false,
          "truncated_stderr": false,
          "normalized_from": null
        }
      ],
      "scan_passed": false,
      "scan_output": "Vulnerability openscap_015: result=fail",
      "duration": 43.862770080566406,
      "success": false,
      "error_summary": null,
      "llm_verdict": {
        "message": "",
        "resolved": false
      }
    }
  ],
  "review_feedback": null
}