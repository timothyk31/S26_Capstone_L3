{
  "vulnerability": {
    "id": "openscap_002",
    "title": "Enable FIPS Mode",
    "severity": "3",
    "cvss": null,
    "host": "localhost",
    "port": null,
    "protocol": null,
    "description": "Red Hat Enterprise Linux 9 has an installation-time kernel flag that can enable FIPS mode. The installer must be booted with fips=1 for the system to have FIPS mode enabled. Enabling FIPS mode on a preexisting system is not supported. If this rule fails on an installed system, then this is a permanent finding and cannot be fixed. To enable FIPS mode at bootable container build time configure fips=1 kernel argument in /usr/lib/bootc/kargs.d/01-fips.toml: kargs = [\"fips=1\"] Then set the cryptographic policy to : update-crypto-policies --no-reload --set",
    "recommendation": "Remediation script: # Remediation is applicable only in certain platforms if ( ! ( [ \"${container:-}\" == \"bwrap-osbuild\" ] ) && rpm --quiet -q kernel-core ); then if { rpm --quiet -q kernel rpm-ostree bootc && ! rpm --quiet -q openshift-kubelet && { [ -f \"/run/.containerenv\" ] || [ -f \"/.containerenv\" ]; }; }; then cat > /usr/lib/bootc/kargs.d/01-fips.toml << EOF kargs = [\"fips=1\"] EOF fi else >&2 echo 'Remediation is not applicable, nothing was done' fi",
    "result": "fail",
    "rule": "xccdf_org.ssgproject.content_rule_enable_fips_mode",
    "oval_id": "xccdf_org.ssgproject.content_rule_enable_fips_mode",
    "scan_class": "compliance",
    "os": "localhost.localdomain"
  },
  "system_context": null
}